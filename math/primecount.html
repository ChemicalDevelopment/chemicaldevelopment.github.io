<html>
 <meta charset="UTF-8"> 
<head>
  <title>Prime Count</title>
	  <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
	</head>
	<body>
      <h1> Math Pages <a href="./index.html">Index</a></h1>
    <div>
      <p>
        This small script graphs the exact number of primes (pi(x) or π(x)), and a few approximations (x/ln(x), and logarithmic integral (Li(x)))
      </p>
    </div>
    <div>
      <input type="number" id="max" value="1000">     
       <input type="button" onclick="drawBackgroundColor()" value="Graph">
      </div>
		<div id="chart_div"></div>
	</body>
<script>
google.charts.load('current', {packages: ['corechart', 'line']});
google.charts.setOnLoadCallback(drawBackgroundColor);
var max_x;
var buff;
var options;
var data;

function drawBackgroundColor() {
      var max_input = document.getElementById("max").value;
      /*window.alert(max_input);*/
      if (max_input != NaN) {
          max_x = max_input;
      } else {
        max_x = 1000;
      }
      buff = Math.ceil(max_x / 250);
      data = new google.visualization.DataTable();
      data.addColumn('number', 'x');
      data.addColumn('number', 'π(x)');
      data.addColumn('number', 'x/ln(x)');
      data.addColumn('number', 'Li(x)');

      var sieve = [];
      var i = 0;
      for (i = 0; i < max_x; ++i) {
      	sieve[i] = true;
      }
      for (i = 2; i < Math.sqrt(max_x); ++i) {
      	if (sieve[i] == false) {
      		continue;
      	}
      	for (var cI = 2 * i; cI < max_x; cI += i) {
      		sieve[cI] = false;
      	}
      }
      sieve[0] = false;
      sieve[1] = false;

      var curCount = 0;
      var j = 0;
      var li_x = 0; //logarithmic  integral function
      var buf_int = 2   ;
      for (i = 0; i <= max_x; ++i) {
      	if (i >= 2) {
      		for (j = 0; j < buf_int; ++j) {
      			li_x += (1 / Math.log(i + j / buf_int)) / buf_int;
      		}
      	}
      	if (sieve[i] == true) {
      		++curCount;
      	}
      	if (i % buff == 0) {
      		data.addRow([i, curCount, i / Math.log(i), li_x]);
      	}
      }

      options = {
        'legend': {'position': 'top'},
        hAxis: {
          title: 'x'
        },
        vAxis: {
          title: 'value'
        },
  		  'height':800,
        backgroundColor: '#fff'
      };

      var chart = new google.visualization.LineChart(document.getElementById('chart_div'));
      chart.draw(data, options);
    }

    document.getElementById('max').onkeydown = function(event) {
    if (event.keyCode == 13) {
        drawBackgroundColor();
    }
}
</script>
</html>